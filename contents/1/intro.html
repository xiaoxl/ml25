<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.9.9">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Introduction – Machine Learning {{&lt; var info.date &gt;}}</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../contents/2/intro.html" rel="next">
<link href="../../index.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-bbfe0a5b9fb228be1b45e71d50e4f997.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-0e3b29b5fa97dc5090eff3fd9e71dcd2.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-bbfe0a5b9fb228be1b45e71d50e4f997.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-c0d2154c8f415210cf187502ecb0c845.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-abfcbbee754f2352fb90360e6f57f36e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-c0d2154c8f415210cf187502ecb0c845.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/quarto-contrib/bookup_fonts_gwf-0.0/fonts-embed.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>



<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Machine Learning 2025 Fall</span>
    </a>
  </div>
        <div class="quarto-navbar-tools tools-end">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../contents/1/intro.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/1/intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/2/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">k-Nearest Neighbors algorithm (k-NN)</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/3/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Decision Trees</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/4/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ensemble methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/5/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Intro to Pytorch</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/6/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/7/intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Netural networks</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../contents/app/setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Python IDE Setup</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-machine-learning" id="toc-what-is-machine-learning" class="nav-link active" data-scroll-target="#what-is-machine-learning"><span class="header-section-number">1.1</span> What is Machine Learning?</a></li>
  <li><a href="#types-of-machine-learning-systems" id="toc-types-of-machine-learning-systems" class="nav-link" data-scroll-target="#types-of-machine-learning-systems"><span class="header-section-number">1.2</span> Types of Machine Learning Systems</a>
  <ul class="collapse">
  <li><a href="#tasks-for-supervised-learning" id="toc-tasks-for-supervised-learning" class="nav-link" data-scroll-target="#tasks-for-supervised-learning"><span class="header-section-number">1.2.1</span> Tasks for Supervised Learning</a></li>
  <li><a href="#classification-based-on-complexity" id="toc-classification-based-on-complexity" class="nav-link" data-scroll-target="#classification-based-on-complexity"><span class="header-section-number">1.2.2</span> Classification based on complexity</a></li>
  </ul></li>
  <li><a href="#basic-setting-for-machine-learning-problems" id="toc-basic-setting-for-machine-learning-problems" class="nav-link" data-scroll-target="#basic-setting-for-machine-learning-problems"><span class="header-section-number">1.3</span> Basic setting for Machine learning problems</a>
  <ul class="collapse">
  <li><a href="#input-and-output-data-structure" id="toc-input-and-output-data-structure" class="nav-link" data-scroll-target="#input-and-output-data-structure"><span class="header-section-number">1.3.1</span> Input and output data structure</a></li>
  <li><a href="#parameters-and-hyperparameters" id="toc-parameters-and-hyperparameters" class="nav-link" data-scroll-target="#parameters-and-hyperparameters"><span class="header-section-number">1.3.2</span> Parameters and hyperparameters</a></li>
  <li><a href="#evaluate-a-machine-learning-model" id="toc-evaluate-a-machine-learning-model" class="nav-link" data-scroll-target="#evaluate-a-machine-learning-model"><span class="header-section-number">1.3.3</span> Evaluate a Machine Learning model</a></li>
  <li><a href="#workflow-in-developing-a-machine-learning-application" id="toc-workflow-in-developing-a-machine-learning-application" class="nav-link" data-scroll-target="#workflow-in-developing-a-machine-learning-application"><span class="header-section-number">1.3.4</span> Workflow in developing a machine learning application</a></li>
  </ul></li>
  <li><a href="#python-quick-guide" id="toc-python-quick-guide" class="nav-link" data-scroll-target="#python-quick-guide"><span class="header-section-number">1.4</span> Python quick guide</a>
  <ul class="collapse">
  <li><a href="#python-notebook" id="toc-python-notebook" class="nav-link" data-scroll-target="#python-notebook"><span class="header-section-number">1.4.1</span> Python Notebook</a></li>
  <li><a href="#python-fundamentals" id="toc-python-fundamentals" class="nav-link" data-scroll-target="#python-fundamentals"><span class="header-section-number">1.4.2</span> Python fundamentals</a></li>
  </ul></li>
  <li><a href="#data-visualization" id="toc-data-visualization" class="nav-link" data-scroll-target="#data-visualization"><span class="header-section-number">1.5</span> Data visualization</a>
  <ul class="collapse">
  <li><a href="#naive-way" id="toc-naive-way" class="nav-link" data-scroll-target="#naive-way"><span class="header-section-number">1.5.1</span> Naive way</a></li>
  <li><a href="#tensorboard" id="toc-tensorboard" class="nav-link" data-scroll-target="#tensorboard"><span class="header-section-number">1.5.2</span> <code>Tensorboard</code></a></li>
  </ul></li>
  <li><a href="#datasets" id="toc-datasets" class="nav-link" data-scroll-target="#datasets"><span class="header-section-number">1.6</span> Datasets</a></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises"><span class="header-section-number">1.7</span> Exercises</a>
  <ul class="collapse">
  <li><a href="#python-notebook-1" id="toc-python-notebook-1" class="nav-link" data-scroll-target="#python-notebook-1"><span class="header-section-number">1.7.1</span> Python Notebook</a></li>
  <li><a href="#basic-python" id="toc-basic-python" class="nav-link" data-scroll-target="#basic-python"><span class="header-section-number">1.7.2</span> Basic Python</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this Chapter we will discuss</p>
<ul>
<li>What is Machine Learning?</li>
<li>What do typical Machine Learning problems look like?</li>
<li>What is the basic structure of Machine Learning models?</li>
<li>What is the basic work flow to use Machine Learning to solve problems?</li>
<li>Some supplementary materials, such as Python.</li>
</ul>
<section id="what-is-machine-learning" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="what-is-machine-learning"><span class="header-section-number">1.1</span> What is Machine Learning?</h2>
<p>Machine Learning is the science (and art) of programming computers so they can <em>learn from data</em> <span class="citation" data-cites="Ger2019">[<a href="../../index.html#ref-Ger2019" role="doc-biblioref">1</a>]</span>.</p>
<p>Here is a slightly more general definition:</p>
<blockquote class="blockquote">
<p>[Machine Learning is the] field of study that gives computers the ability to learn without being explicitly programmed.</p>
<pre><code>                                           -- Arthur Samuel, 1959</code></pre>
</blockquote>
<p>This “<mark>without being explicitly programmed to do so</mark>” is the essential difference between Machine Learning and usual computing tasks. The usual way to make a computer do useful work is to have a human programmer write down rules — a computer program — to be followed to turn input data into appropriate answers. Machine Learning turns this around: the machine looks at the input data and the expected task outcome, and figures out what the rules should be. A Machine Learning system is <em>trained</em> rather than explicitly programmed. It’s presented with many examples relevant to a task, and it finds statistical structure in these examples that eventually allows the system to come up with rules for automating the task <span class="citation" data-cites="Cho2021">[<a href="../../index.html#ref-Cho2021" role="doc-biblioref">2</a>]</span>.</p>
</section>
<section id="types-of-machine-learning-systems" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="types-of-machine-learning-systems"><span class="header-section-number">1.2</span> Types of Machine Learning Systems</h2>
<p>There are many different types of Machine Learning systems that it is useful to classify them in braod categories, based on different criteria. These criteria are not exclusive, and you can combine them in any way you like.</p>
<p>The most popular criterion for Machine Learning classification is the amount and type of supervision they get during training. In this case there are four major types.</p>
<p><strong>Supervised Learning</strong> The training set you feed to the algorithm includes the desired solutions. The machines learn from the data to alter the model to get the desired output. The main task for Supervised Learning is classification and regression.</p>
<p><strong>Unsupervised Learning</strong> In Unsupervised Learning, the data provided doesn’t have class information or desired solutions. We just want to dig some information directly from those data themselves. Usually Unsupervised Learning is used for clustering and dimension reduction.</p>
<p><strong>Reinforcement Learning</strong> In Reinforcement Learning, there is a reward system to measure how well the machine performs the task, and the machine is learning to find the strategy to maximize the rewards. Typical examples here include gaming AI and walking robots.</p>
<p><strong>Semisupervised Learning</strong> This is actually a combination of Supervised Learning and Unsupervised Learning, that it is usually used to deal with data that are half labelled.</p>
<section id="tasks-for-supervised-learning" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="tasks-for-supervised-learning"><span class="header-section-number">1.2.1</span> Tasks for Supervised Learning</h3>
<p>As mentioned above, for Supervised Learning, there are two typical types of tasks:</p>
<p><strong>Classification</strong> It is the task of predicting a discrete class labels. A typical classification problem is to see an handwritten digit image and recognize it.</p>
<p><strong>Regression</strong> It is the task of predicting a continuous quantity. A typical regression problem is to predict the house price based on various features of the house.</p>
<p>There are a lot of other tasks that are not directly covered by these two, but these two are the most classical Supervised Learning tasks.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In this course we will mainly focus on <strong>Supervised Classification problems</strong>.</p>
</div>
</div>
</section>
<section id="classification-based-on-complexity" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="classification-based-on-complexity"><span class="header-section-number">1.2.2</span> Classification based on complexity</h3>
<p>Along with the popularity boost of deep neural network, there comes another classificaiton: shallow learning vs.&nbsp;deep learning. Basically all but deep neural network belongs to shallow learning. Although deep learning can do a lot of fancy stuffs, shallow learning is still very good in many cases. When the performance of a shallow learning model is good enough comparing to that of a deep learning model, people tend to use the shallow learning since it is usually faster, easier to understand and easier to modify.</p>
</section>
</section>
<section id="basic-setting-for-machine-learning-problems" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="basic-setting-for-machine-learning-problems"><span class="header-section-number">1.3</span> Basic setting for Machine learning problems</h2>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We by default assume that we are dealing with a <strong>Supervised</strong> <strong>Classification</strong> problem.</p>
</div>
</div>
<section id="input-and-output-data-structure" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="input-and-output-data-structure"><span class="header-section-number">1.3.1</span> Input and output data structure</h3>
<p>Since we are dealing with Supervised Classification problems, the desired solutions are given. These desired solutions in Classification problems are also called <em>labels</em>. The properties that the data are used to describe are called <em>features</em>. Both features and labels are usually organized as row vectors.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.1</strong></span> The example is extracted from <span class="citation" data-cites="Har2012">[<a href="../../index.html#ref-Har2012" role="doc-biblioref">3</a>]</span>. There are some sample data shown in the following table. We would like to use these information to classify bird species.</p>
<div class="cell" data-execution_count="1">
<div id="tbl-table" class="cell quarto-float quarto-figure quarto-figure-center anchored" data-execution_count="1">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.1: Bird species classification based on four features
</figcaption>
<div aria-describedby="tbl-table-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output cell-output-display" data-execution_count="1">
<style type="text/css">
#T_f30ae th {
  text-align: right;
}
#T_f30ae_row0_col0, #T_f30ae_row0_col1, #T_f30ae_row0_col2, #T_f30ae_row0_col3, #T_f30ae_row0_col4, #T_f30ae_row1_col0, #T_f30ae_row1_col1, #T_f30ae_row1_col2, #T_f30ae_row1_col3, #T_f30ae_row1_col4, #T_f30ae_row2_col0, #T_f30ae_row2_col1, #T_f30ae_row2_col2, #T_f30ae_row2_col3, #T_f30ae_row2_col4, #T_f30ae_row3_col0, #T_f30ae_row3_col1, #T_f30ae_row3_col2, #T_f30ae_row3_col3, #T_f30ae_row3_col4, #T_f30ae_row4_col0, #T_f30ae_row4_col1, #T_f30ae_row4_col2, #T_f30ae_row4_col3, #T_f30ae_row4_col4, #T_f30ae_row5_col0, #T_f30ae_row5_col1, #T_f30ae_row5_col2, #T_f30ae_row5_col3, #T_f30ae_row5_col4 {
  text-align: right;
}
</style>

<table id="T_f30ae" class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th id="T_f30ae_level0_col0" class="col_heading level0 col0" data-quarto-table-cell-role="th">Weight (g)</th>
<th id="T_f30ae_level0_col1" class="col_heading level0 col1" data-quarto-table-cell-role="th">Wingspan (cm)</th>
<th id="T_f30ae_level0_col2" class="col_heading level0 col2" data-quarto-table-cell-role="th">Webbed feet?</th>
<th id="T_f30ae_level0_col3" class="col_heading level0 col3" data-quarto-table-cell-role="th">Back color</th>
<th id="T_f30ae_level0_col4" class="col_heading level0 col4" data-quarto-table-cell-role="th">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td id="T_f30ae_row0_col0" class="data row0 col0">1000.100000</td>
<td id="T_f30ae_row0_col1" class="data row0 col1">125.000000</td>
<td id="T_f30ae_row0_col2" class="data row0 col2">No</td>
<td id="T_f30ae_row0_col3" class="data row0 col3">Brown</td>
<td id="T_f30ae_row0_col4" class="data row0 col4">Buteo jamaicensis</td>
</tr>
<tr class="even">
<td id="T_f30ae_row1_col0" class="data row1 col0">3000.700000</td>
<td id="T_f30ae_row1_col1" class="data row1 col1">200.000000</td>
<td id="T_f30ae_row1_col2" class="data row1 col2">No</td>
<td id="T_f30ae_row1_col3" class="data row1 col3">Gray</td>
<td id="T_f30ae_row1_col4" class="data row1 col4">Sagittarius serpentarius</td>
</tr>
<tr class="odd">
<td id="T_f30ae_row2_col0" class="data row2 col0">3300.000000</td>
<td id="T_f30ae_row2_col1" class="data row2 col1">220.300000</td>
<td id="T_f30ae_row2_col2" class="data row2 col2">No</td>
<td id="T_f30ae_row2_col3" class="data row2 col3">Gray</td>
<td id="T_f30ae_row2_col4" class="data row2 col4">Sagittarius serpentarius</td>
</tr>
<tr class="even">
<td id="T_f30ae_row3_col0" class="data row3 col0">4100.000000</td>
<td id="T_f30ae_row3_col1" class="data row3 col1">136.000000</td>
<td id="T_f30ae_row3_col2" class="data row3 col2">Yes</td>
<td id="T_f30ae_row3_col3" class="data row3 col3">Black</td>
<td id="T_f30ae_row3_col4" class="data row3 col4">Gavia immer</td>
</tr>
<tr class="odd">
<td id="T_f30ae_row4_col0" class="data row4 col0">3.000000</td>
<td id="T_f30ae_row4_col1" class="data row4 col1">11.000000</td>
<td id="T_f30ae_row4_col2" class="data row4 col2">No</td>
<td id="T_f30ae_row4_col3" class="data row4 col3">Green</td>
<td id="T_f30ae_row4_col4" class="data row4 col4">Calothorax lucifer</td>
</tr>
<tr class="even">
<td id="T_f30ae_row5_col0" class="data row5 col0">570.000000</td>
<td id="T_f30ae_row5_col1" class="data row5 col1">75.000000</td>
<td id="T_f30ae_row5_col2" class="data row5 col2">No</td>
<td id="T_f30ae_row5_col3" class="data row5 col3">Black</td>
<td id="T_f30ae_row5_col4" class="data row5 col4">Campephilus principalis</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The first four columns are features, and the last column is the label. The first two features are numeric and can take on decimal values. The third feature is binary that can only be <span class="math inline">\(1\)</span> (Yes) or <span class="math inline">\(0\)</span> (No). The fourth feature is an enumeration over the color palette. You may either treat it as categorical data or numeric data, depending on how you want to build the model and what you want to get out of the data. In this example we will use it as categorical data that we only choose it from a list of colors (<span class="math inline">\(1\)</span> — Brown, <span class="math inline">\(2\)</span> — Gray, <span class="math inline">\(3\)</span> — Black, <span class="math inline">\(4\)</span> — Green).</p>
<p>Then we are able to transform the above data into the following form:</p>
<div id="tbl-vectorized" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-vectorized-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1.2: Vectorized Bird species data
</figcaption>
<div aria-describedby="tbl-vectorized-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<thead>
<tr class="header">
<th>Features</th>
<th>Labels</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix}1001.1 &amp; 125.0 &amp; 0 &amp; 1 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(1\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\begin{bmatrix}3000.7 &amp; 200.0 &amp; 0 &amp; 2 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(2\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix}3300.0 &amp; 220.3 &amp; 0 &amp; 2 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(2\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\begin{bmatrix}4100.0 &amp; 136.0 &amp; 1 &amp; 3 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(3\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\begin{bmatrix}3.0 &amp; 11.0 &amp; 0 &amp; 4 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(4\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\begin{bmatrix}570.0 &amp; 75.0 &amp; 0 &amp; 3 \end{bmatrix}\)</span></td>
<td><span class="math inline">\(5\)</span></td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>Then the Supervised Learning problem is stated as follows: Given the features and the labels, we would like to find a model that can classify future data.</p>
</div>
</section>
<section id="parameters-and-hyperparameters" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="parameters-and-hyperparameters"><span class="header-section-number">1.3.2</span> Parameters and hyperparameters</h3>
<p>A model parameter is internal to the model and its value is learned from the data.</p>
<p>A model hyperparameter is external to the model and its value is set by people.</p>
<p>For example, assume that we would like to use Logistic regression to fit the data. We set the learning rate is <code>0.1</code> and the maximal iteration is <code>100</code>. After the computations are done, we get a the model</p>
<p><span class="math display">\[
y = \sigma(0.8+0.7x).
\]</span> The two cofficients <span class="math inline">\(0.8\)</span> and <span class="math inline">\(0.7\)</span> are the parameters of the model. The model <code>Logistic regression</code>, the learning rate <code>0.1</code> and the maximal iteration <code>100</code> are all hyperparametrs. If we change to a different set of hyperparameters, we may get a different model, with a different set of parameters.</p>
<p>The details of Logistic regression will be discussed later.</p>
</section>
<section id="evaluate-a-machine-learning-model" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="evaluate-a-machine-learning-model"><span class="header-section-number">1.3.3</span> Evaluate a Machine Learning model</h3>
<p>Once the model is built, how do we know that it is good or not? The naive idea is to test the model on some brand new data and check whether it is able to get the desired results. The usual way to achieve it is to split the input dataset into three pieces: <em>training set</em>, <em>validation set</em> and <em>test set</em>.</p>
<p>The model is initially fit on the training set, with some arbitrary selections of hyperparameters. Then hyperparameters will be changed, and new model is fitted over the training set. Which set of hyperparameters is better? We then test their performance over the validation set. We could run through a lot of different combinations of hyperparameters, and find the best performance over the validation set. After we get the best hyperparameters, the model is selcted, and we fit it over the training set to get our model to use.</p>
<p>To compare our model with our models, either our own model using other algorithms, or models built by others, we need some new data. We can no longer use the training set and the validation set since all data in them are used, either for training or for hyperparameters tuning. We need to use the test set to evaluate the “real performance” of our data.</p>
<p>To summarize:</p>
<ul>
<li>Training set: used to fit the model;</li>
<li>Validation set: used to tune the hyperparameters;</li>
<li>Test set: used to check the overall performance of the model.</li>
</ul>
<p>The validation set is not always required. If we use cross-validation technique for hyperparameters tuning, like <code>sklearn.model_selection.GridSearchCV()</code>, we don’t need a separated validation set. In this case, we will only need the training set and the test set, and run <code>GridSearchCV</code> over the training set. The cross-validation will be discussed in <a href="../2/intro.html#sec-cross-validation" class="quarto-xref"><span>Section 2.2.5</span></a>.</p>
<p>The sizes and strategies for dataset division depends on the problem and data available. It is often recommanded that more training data should be used. The typical distribution of training, validation and test is <span class="math inline">\((6:3:1)\)</span>, <span class="math inline">\((7:2:1)\)</span> or <span class="math inline">\((8:1:1)\)</span>. Sometimes validation set is discarded and only training set and test set are used. In this case the distribution of training and test set is usually <span class="math inline">\((7:3)\)</span>, <span class="math inline">\((8:2)\)</span> or <span class="math inline">\((9:1)\)</span>.</p>
</section>
<section id="workflow-in-developing-a-machine-learning-application" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="workflow-in-developing-a-machine-learning-application"><span class="header-section-number">1.3.4</span> Workflow in developing a machine learning application</h3>
<p>The workflow described below is from <span class="citation" data-cites="Har2012">[<a href="../../index.html#ref-Har2012" role="doc-biblioref">3</a>]</span>.</p>
<ol type="1">
<li>Collect data.</li>
<li>Prepare the input data.</li>
<li>Analyze the input data.</li>
<li>Train the algorithm.</li>
<li>Test the algorithm.</li>
<li>Use it.</li>
</ol>
<p>In this course, we will mainly focus on Step 4 as well Step 5. These two steps are where the “core” algorithms lie, depending on the algorithm. We will start from the next Chapter to talk about various Machine Learning algorithms and examples.</p>
<!-- 
## Output data structure

### Binary Classification Problem
When there are only one class, and all we care about is whether a data point belongs to this class or not, we call this type of problem **binary classification** problem. 

In this case, the desired output for each data point is either $1$ or $0$, where $1$ means "belonging to this class" and $0$ means "not belonging to this class".

If there are two classes, we can still use the idea of binary classification to study the problem. We choose one class as our focus. When the data point belongs to the other class, we can simply say it does belong to the class we choose.

### $0$ and $1$
In many cases the desired output is either $0$ or $1$, while the output of the model is a real number between $0$ and $1$. In this case, the output of the model is interpreted as the probability for the data to be in the specific class. When we use this model, we simply choose the class that has the highest probability and claim that the data is belonging to this class. 

In the binary case, the above method can be stated in another way. We choose a threshold, and treat those whose probability are above the threshold to be in the class, and others not. The default value for the threshold is $0.5$, and in this case the method is just a special case for the previous method. 

### One-hot coding -->
</section>
</section>
<section id="python-quick-guide" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="python-quick-guide"><span class="header-section-number">1.4</span> Python quick guide</h2>
<section id="python-notebook" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="python-notebook"><span class="header-section-number">1.4.1</span> Python Notebook</h3>
<p>We mainly use Jupyter Notebook (.ipynb) to write documents for this course. Currently most main stream Python IDEs support Jupyter Notebook. They are not entirely identical but the differences are not huge and you may choose any you like. In this course we recommand using VS Code. The setup can be found in Appendix <a href="../app/setup.html#sec-vscode" class="quarto-xref"><span>Section A.1</span></a>.</p>
</section>
<section id="python-fundamentals" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="python-fundamentals"><span class="header-section-number">1.4.2</span> Python fundamentals</h3>
<p>We will put some very basic Python commands here for you to warm up. More advanced Python knowledge will be covered during the rest of the semester. The main reference for this part is <span class="citation" data-cites="Har2012">[<a href="../../index.html#ref-Har2012" role="doc-biblioref">3</a>]</span>. Another referenece is <a href="https://xiaoxl.github.io/pr24/">My notes</a>.</p>
<section id="indentation" class="level4" data-number="1.4.2.1">
<h4 data-number="1.4.2.1" class="anchored" data-anchor-id="indentation"><span class="header-section-number">1.4.2.1</span> Indentation</h4>
<p>Python is using indentation to denote code blocks. It is not convienent to write in the first place, but it forces you to write clean, readable code.</p>
<p>By the way, the <code>if</code> and <code>for</code> block are actually straightforward.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> jj <span class="op">&lt;</span> <span class="dv">3</span>:</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    jj <span class="op">=</span> jj </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"It is smaller than 3."</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> jj <span class="op">&lt;</span> <span class="dv">3</span>:</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    jj <span class="op">=</span> jj</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"It is smaller than 3."</span>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">3</span>):</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>    i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(i)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="quarto-layout-panel" data-layout-nrow="2">
<div class="quarto-layout-row">

</div>
<div class="quarto-layout-row">

</div>
</div>
<p>Please tell the differences between the above codes.</p>
</section>
<section id="list-and-dict" class="level4" data-number="1.4.2.2">
<h4 data-number="1.4.2.2" class="anchored" data-anchor-id="list-and-dict"><span class="header-section-number">1.4.2.2</span> <code>list</code> and <code>dict</code></h4>
<p>Here are some very basic usage of lists of dictionaries in Python.</p>
<div id="9c0a871d" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>newlist <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>newlist.append(<span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>newlist.append(<span class="st">'hello'</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>newlist</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[1, 'hello']</code></pre>
</div>
</div>
<div id="c3add18d" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>newlisttwo <span class="op">=</span> [<span class="dv">1</span>, <span class="st">'hello'</span>]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>newlisttwo</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<pre><code>[1, 'hello']</code></pre>
</div>
</div>
<div id="d17d165c" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>newdict <span class="op">=</span> <span class="bu">dict</span>()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>newdict[<span class="st">'one'</span>] <span class="op">=</span> <span class="st">'good'</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>newdict[<span class="dv">1</span>] <span class="op">=</span> <span class="st">'yes'</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>newdict</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>{'one': 'good', 1: 'yes'}</code></pre>
</div>
</div>
<div id="57d2d7d1" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>newdicttwo <span class="op">=</span> {<span class="st">'one'</span>: <span class="st">'good'</span>, <span class="dv">1</span>: <span class="st">'yes'</span>}</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>newdicttwo</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>{'one': 'good', 1: 'yes'}</code></pre>
</div>
</div>
</section>
<section id="loop-through-lists" class="level4" data-number="1.4.2.3">
<h4 data-number="1.4.2.3" class="anchored" data-anchor-id="loop-through-lists"><span class="header-section-number">1.4.2.3</span> Loop through lists</h4>
<p>When creating <code>for</code> loops we may let Python directly loop through lists. Here is an example. The code is almost self-explained.</p>
<div id="c0f6ed08" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>alist <span class="op">=</span> [<span class="st">'one'</span>, <span class="dv">2</span>, <span class="st">'three'</span>, <span class="dv">4</span>]</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> item <span class="kw">in</span> alist:</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(item)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>one
2
three
4</code></pre>
</div>
</div>
</section>
<section id="reading-files" class="level4" data-number="1.4.2.4">
<h4 data-number="1.4.2.4" class="anchored" data-anchor-id="reading-files"><span class="header-section-number">1.4.2.4</span> Reading files</h4>
<p>There are a lot of functions that can read files. The basic one is to read any files as a big string. After we get the string, we may parse it based on the structure of the data.</p>
<p>The above process sounds complicated. That’s why we have so many different functions reading files. Usually they focus on a certain types of files (e.g.&nbsp;spreadsheets, images, etc..), parse the data into a particular data structure for us to use later.</p>
<p>I will mention a few examples.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span><code>csv</code> files and <code>excel</code> files
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Both of them are spreadsheets format. Usually we use <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_csv.html"><code>pandas.read_csv</code></a> and <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html"><code>pandas.read_excel</code></a> both of which are from the package <code>pandas</code> to read these two types of files. When reading <code>excel</code>, package <code>openpyxl</code> is needed.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>images
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Images can be treated as matrices, that each entry represents one pixel. If the image is black/white, it is represented by one matrix where each entry represents the gray value. If the image is colored, it is represented by three matrices where each entry represents one color. To use which three colors depends on the color map. <code>rgb</code> is a popular choice.</p>
<p>In this course when we need to read images, we usually use <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imread.html"><code>matplotlib.pyplot.imread</code></a> from the package <code>matplotlib</code> or <a href="https://docs.opencv.org/4.x/d4/da8/group__imgcodecs.html#ga288b8b3da0892bd651fce07b3bbd3a56"><code>cv.imread</code></a> from the package <code>opencv</code>.</p>
</div>
</div>
</div>
<!-- 
::: {.callout-note collapse="true"}
## `.json` files
`.json` is a file format to store dictionary type of data. To read a `json` file and parse it as a dictionary, we need [`json.load`](https://docs.python.org/3/library/json.html#json.load) from the package `json`. 
::: -->
</section>
<section id="writing-files" class="level4" data-number="1.4.2.5">
<h4 data-number="1.4.2.5" class="anchored" data-anchor-id="writing-files"><span class="header-section-number">1.4.2.5</span> Writing files</h4>
<ul>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_csv.html"><code>pandas.DataFrame.to_csv</code></a></li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.to_excel.html"><code>pandas.DataFrame.to_excel</code></a></li>
<li><a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.figure.Figure.savefig.html#matplotlib.figure.Figure.savefig"><code>matplotlib.figure.Figure.savefig()</code></a> <!-- - [`cv.imwrite`](https://docs.opencv.org/3.4/d4/da8/group__imgcodecs.html#gabbc7ef1aa2edfaa87772f1202d67e0ce) --> <!-- - [`json.dump`](https://docs.python.org/3/library/json.html#json.dump) --></li>
</ul>
</section>
<section id="relative-paths" class="level4" data-number="1.4.2.6">
<h4 data-number="1.4.2.6" class="anchored" data-anchor-id="relative-paths"><span class="header-section-number">1.4.2.6</span> Relative paths</h4>
<p>In this course, when reading and writing files, please keep all the files using relative paths. That is, only write the path starting from the working directory.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.2</strong></span> Consider the following tasks:</p>
<ol type="1">
<li>Your working directory is <code>C:/Users/Xinli/projects/</code>.</li>
<li>Want to read a file <code>D:/Files/example.csv</code>.</li>
<li>Want to generate a file whose name is <code>result.csv</code> and put it in a subfoler named <code>foldername</code>.</li>
</ol>
<p>To do the tasks, don’t directly run the code <code>pd.read_csv('D:/Files/example.csv')</code>. Instead you should first copy the file to your working directory <code>C:/Users/Xinli/projects/</code>, and then run the following code.</p>
<div id="ce7b11ba" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'example.csv'</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>df.to_csv(<span class="st">'foldername/result.csv'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Please pay attention to how the paths are written.</p>
</div>
<!-- 

#### `.`

- class and packages.
- Get access to attributes and methods
- Chaining dots. -->
<!-- ### Some additional topics -->
<!-- 
You may read about these parts from the appendices of [My notes](https://xiaoxl.github.io/pr23f/contents/app/virtenv.html).

#### Package management and Virtual environment

- [`conda`](https://conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html)
  - `conda create`
    - `conda create --name myenv` 
    - `conda create --name myenv python=3.9` 
    - `conda create --name myenv --file spec-file.txt`
  - `conda install`
    - `conda install -c conda-forge numpy`
  - `conda activate myenv`
  - `conda list`
    - `conda list numpy`
    - `conda list --explicit > spec-file.txt`
  - `conda env list`
- `pip` / [`venv`](https://docs.python.org/3/library/venv.html)
  - `python -m venv newenv`
  - `newenv\Scripts\activate`
  - `pip install`
  - `pip freeze > requirements.txt`
  - `pip install -r /path/to/requirements.txt`
  - `deactivate`

#### Version Control

- `Git`
  - [Install](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git)
  - `git config --list`
  - `git config --global user.name "My Name"`
  - `git config --global user.email "myemail@example.com"`
- `GitHub` -->
</section>
</section>
</section>
<section id="data-visualization" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="data-visualization"><span class="header-section-number">1.5</span> Data visualization</h2>
<p>We need to visualize the data during toying with models, especialy when we want to keep track of metrcis to evaluate the performance of our model. We will introduce two ways for the visualization.</p>
<section id="naive-way" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="naive-way"><span class="header-section-number">1.5.1</span> Naive way</h3>
<p>The idea is to record the data we want to visualize, and then direct display the data with a certain visualization library. The most popular and default choice is <code>matplotlib</code>. Although there are many customizations, the basic usage is very simple.</p>
<div id="b31de818" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y, label<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>plt.plot(x, z, label<span class="op">=</span><span class="st">'z'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_files/figure-html/cell-13-output-1.png" width="569" height="411" class="figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Since in most cases in this course we would like to see line plot, this piece of code shows the main usage.</p>
<ul>
<li>We need to specify two series of data as <code>x</code> and <code>y</code> respectively.</li>
<li>We could show two lines in the same plot.</li>
<li>If we add labels, and show legend, legends and labels in the plot will be automatically generated.</li>
</ul>
<div id="5e717ee4" class="cell" data-execution_count="13">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>ax.plot(x, y, label<span class="op">=</span><span class="st">'y'</span>)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ax.plot(x, z, label<span class="op">=</span><span class="st">'z'</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">'x'</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">'y and z'</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">'Example'</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>fig.set_size_inches((<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>fig.set_dpi(<span class="dv">100</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'example.png'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_files/figure-html/cell-14-output-1.png" width="534" height="392" class="figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="tensorboard" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="tensorboard"><span class="header-section-number">1.5.2</span> <code>Tensorboard</code></h3>
<details>
<summary>
This section is optional.
</summary>
<p>Instead of manually recording data and show plots, we could use logging tools for visualization. Similar to libraries, there are many tools of choice. <code>tensorboard</code> is one of simpler tools. <code>tensorboard</code> originally is a tool for <code>tensorflow</code>. It later joins <code>PyTorch</code> and becomes a (relatively independent) tool. Here we will use it with <code>PyTorch</code> since in the second half of the semester we will talk about <code>PyTorch</code>. To install <code>tensorboard</code> after you install <code>PyTorch</code> you could use the following command. More details can be found <a href="https://pytorch.org/tutorials/beginner/introyt/tensorboardyt_tutorial.html">here</a>. Note that <code>tensorboard</code> depends on <code>matplotlib</code> therefore they have to be installed simutanously.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb16"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="ex">pip</span> install matplotlib tensorboard</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>The basic idea of tensorboard is that it is logger that record the information you send to it. It can then retrieve the information and show some plots later. Whether the plots are good or not depends on how you structure the data sent to it. There are many customizations. Here we will only discuss one way to use it.</p>
<p>The mindset of using <code>tensorboard</code> is as follows. 1. A logger should be initialized to accept your data. 2. For organization, we put the logs in a foler structure. 3. During runs, we send data to the logger. 4. After the run, the logger is closed. 5. We could later run <code>tensorboard</code> to load these logs to see the data we generated during runs.</p>
<div id="0808558c" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.tensorboard <span class="im">import</span> SummaryWriter</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>writer <span class="op">=</span> SummaryWriter(<span class="st">'runs/ex1'</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    writer.add_scalar(<span class="st">'y'</span>, y[i], x[i])</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    writer.add_scalar(<span class="st">'z'</span>, z[i], x[i])</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>writer.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>This piece of code shows the basic usage of <code>tensorboard</code>.</p>
<ol type="1">
<li>We first initialize the logger and put it in the folder <code>runs/ex1</code>. Note that if this folder is not assigned, a folder with random name will be generated. But if the name is assigned like what we do here, the logs will be recorded in this folder everytime we run the code. This is NOT recommended.</li>
<li>Then we use <code>.add_scalar</code> to send the data we need to the logger one by one. Note that for these scalar data the three arguments are <code>label</code>, <code>value</code> and <code>independent variable</code>.</li>
<li>At the end, the logger will be closed and saved to disk.</li>
</ol>
<p>To visualize the result, you may type the command in comma line, and <code>tensorboard</code> will then let you know where you can visualize the data.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb18"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="ex">tensorboard</span> <span class="at">--logdir</span><span class="op">=</span>runs/ex1 </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<pre><code>TensorBoard 2.18.0 at http://localhost:6006/ (Press CTRL+C to quit)</code></pre>
<p>Click the link, you will see tensorboard as follows.</p>
<p><img src="assests/img/20250228164959.png" class="img-fluid"></p>
<p>How <code>tensorboard</code> show the data depends on how you structure your data. Here I suggest a way to organize the data you send to <code>tensorboard</code>.</p>
<ol type="1">
<li>Use date/time and other indicators as the name of each run.</li>
<li>Group similar metrics together and record them in a dictionary.</li>
<li>When using a dictionary to send many scalars, use <code>add_scalars</code> instead of <code>add_scalar</code>.</li>
</ol>
<div id="756d5675" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> torch.utils.tensorboard <span class="im">import</span> SummaryWriter</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> datetime <span class="im">import</span> datetime</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>runfolder <span class="op">=</span> datetime.now().strftime(<span class="st">'%Y</span><span class="sc">%d</span><span class="st">%m-%H%M%S'</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>writer <span class="op">=</span> SummaryWriter(<span class="ss">f'runs/</span><span class="sc">{</span>runfolder<span class="sc">}</span><span class="ss">'</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="op">-</span><span class="dv">2</span>, <span class="dv">3</span>]</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">5</span>):</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    scalars <span class="op">=</span> {</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'y'</span>: y[i],</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'z'</span>: z[i]</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    writer.add_scalars(<span class="st">'scalars'</span>, scalars, x[i])</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>writer.close()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><img src="assests/img/20250228170146.png" class="img-fluid"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the plots from <code>tensorboard</code> and <code>matplotlib</code> are a little different. The reason is that <code>tensorboard</code> automatically smooth the curve. You can use the cmoothing factor to control the effect. When you change it to be 0, you will get exactly the same plot.</p>
</div>
</div>
<hr>
</details>
</section>
</section>
<section id="datasets" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="datasets"><span class="header-section-number">1.6</span> Datasets</h2>
<p>You should have a dataset to build a machine learning model. The datasets usually come in different formats.</p>
<ul>
<li>You are provided with the dataset files.</li>
<li>You load the dataset from public repository.</li>
</ul>
<p>After you get the dataset, there should be some preprocessing steps to change the dataset into the format we need.</p>
<!-- 
### Working with dataset repositories -->
<p>huggingface</p>
<p>from packages</p>
</section>
<section id="exercises" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="exercises"><span class="header-section-number">1.7</span> Exercises</h2>
<p>These exercises are from <span class="citation" data-cites="Klo2021">[<a href="../../index.html#ref-Klo2021" role="doc-biblioref">4</a>]</span>, <span class="citation" data-cites="Ger2019">[<a href="../../index.html#ref-Ger2019" role="doc-biblioref">1</a>]</span> and <span class="citation" data-cites="Har2012">[<a href="../../index.html#ref-Har2012" role="doc-biblioref">3</a>]</span>.</p>
<section id="python-notebook-1" class="level3" data-number="1.7.1">
<h3 data-number="1.7.1" class="anchored" data-anchor-id="python-notebook-1"><span class="header-section-number">1.7.1</span> Python Notebook</h3>
<div id="exr-helloworld" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.1 (Hello World!)</strong></span> Please set up a Python Notebook environment and type <code>print('Hello World!')</code>.</p>
</div>
<div id="exr-" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.2</strong></span> Please set up a Python Notebook and start a new virtual environment and type <code>print('Hello World!')</code>.</p>
</div>
</section>
<section id="basic-python" class="level3" data-number="1.7.2">
<h3 data-number="1.7.2" class="anchored" data-anchor-id="basic-python"><span class="header-section-number">1.7.2</span> Basic Python</h3>
<div id="exr-ex1helloworld" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.3 (Play with lists)</strong></span> Please complete the following tasks.</p>
<ul>
<li>Write a <code>for</code> loop to print values from 0 to 4.</li>
<li>Combine two lists <code>['apple', 'orange']</code> and <code>['banana']</code> using <code>+</code>.</li>
<li>Sort the list <code>['apple', 'orange', 'banana']</code> using <code>sorted()</code>.</li>
</ul>
</div>
<!-- 
````vxurwfkoqz ex1helloworld
:class: dropdown

```ihfoduxywssz python
for i in range(5):
    print(i)

newlist = ['apple', 'orange'] + ['banana']

sorted(['apple', 'orange', 'banana'])
```

Please be careful about the last line. `sorted()` doesn't change the original list. It create a new list. There are some Python functions which change the inputed object in-place. Please read documents on all packages you use to get the desired results.
```` -->
<div id="exr-ex1list" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.4 (Play with list, dict and pandas.)</strong></span> Please complete the following tasks.</p>
<ul>
<li>Create a new dictionary <code>people</code> with two keys <code>name</code> and <code>age</code>. The values are all empty list.</li>
<li>Add <code>Tony</code> to the <code>name</code> list in <code>people</code>.</li>
<li>Add <code>Harry</code> to the <code>name</code> list in <code>people</code>.</li>
<li>Add number 100 to the <code>age</code> list in <code>people</code>.</li>
<li>Add number 10 to the <code>age</code> list in <code>people</code>.</li>
<li>Find all the keys of <code>people</code> and save them into a list <code>namelist</code>.</li>
<li>Convert the dictionary <code>people</code> to a Pandas DataFrame <code>df</code>.</li>
</ul>
</div>
<!-- ````{solution} ex1list
:class: dropdown
```ihfoduxywssz python
import pandas as pd

people = {'name': list(), 'age': list()}
people['name'].append('Tony')
people['name'].append('Harry')
people['age'].append(100)
people['age'].append(10)

namelist = people.keys()

df = pd.DataFrame(people)
```
```` -->
<div id="exr-ex1iris" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.5 (The dataset iris)</strong></span> &nbsp;</p>
<div id="ab73cba0" class="cell" data-execution_count="16">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> load_iris</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> load_iris()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Please explore this dataset.</p>
<ul>
<li>Please get the features for <code>iris</code> and save it into <code>X</code> as an numpy array.</li>
<li>What is the meaning of these features?</li>
<li>Please get the labels for <code>iris</code> and save it into <code>y</code> as an numpy array.</li>
<li>What is the meaning of labels?</li>
</ul>
</div>
<!-- ````{solution} ex1iris
:class: dropdown
We first find that `iris` is a dictionary. Then we can look at all the keys by `iris.keys()`. The interesting keys are `data`, `target`, `target_names` and `feature_names`. We can also read the description of the dataset by looking at `DESCR`. 
```ihfoduxywssz python
X = iris['data']
print(iris['feature_names'])
y = iris['target']
print(iris['target'])
```
Since the data is already saved as numpy arrays, we don't need to do anything to change its type.
```` -->
<div id="exr-ex1pandastitanic" class="theorem exercise">
<p><span class="theorem-title"><strong>Exercise 1.6 (Play with Pandas)</strong></span> Please download the Titanic data file from <a href="./assests/datasets/titanic.csv">here</a>. Then follow the instructions to perform the required tasks.</p>
<ul>
<li>Use <code>pandas.read_csv</code> to read the dataset and save it as a dataframe object <code>df</code>.</li>
<li>Change the values of the <code>Sex</code> column that <code>male</code> is <code>0</code> and <code>female</code> is <code>1</code>.</li>
<li>Pick the columns <code>Pclass</code>, <code>Sex</code>, <code>Age</code>, <code>Siblings/Spouses Aboard</code>, <code>Parents/Children Aboard</code> and <code>Fare</code> and transform them into a 2-dimensional <code>numpy.ndarray</code>, and save it as <code>X</code>.</li>
<li>Pick the column <code>Survived</code> and transform it into a 1-dimensional <code>numpy.ndarray</code> and save it as <code>y</code>.</li>
</ul>
</div>
<!-- ````{solution} ex1pandastitanic
:class: dropdown

Not yet done!
```` -->


<div id="refs" class="references csl-bib-body" role="list" style="display: none">
<div id="ref-Ger2019" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline"><span class="smallcaps">Géron</span>, A. (2019). <em>Hands-on machine learning with scikit-learn, keras, and TensorFlow concepts, tools, and techniques to build intelligent systems: Concepts, tools, and techniques to build intelligent systems</em>. O’Reilly Media.</div>
</div>
<div id="ref-Cho2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline"><span class="smallcaps">Chollet</span>, F. (2021). <em><a href="https://www.manning.com/books/deep-learning-with-python-second-edition">Deep learning with python, second edition</a></em>. MANNING PUBN.</div>
</div>
<div id="ref-Har2012" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline"><span class="smallcaps">Harrington</span>, P. (2012). <em><a href="https://www.manning.com/books/machine-learning-in-action">Machine learning in action</a></em>. Manning Publications.</div>
</div>
<div id="ref-Klo2021" class="csl-entry" role="listitem">
<div class="csl-left-margin">[4] </div><div class="csl-right-inline"><span class="smallcaps">Klosterman</span>, S. (2021). <em><a href="https://www.packtpub.com/product/data-science-projects-with-python/9781838551025">Data science projects with python: A case study approach to gaining valuable insights from real data with machine learning</a></em>. Packt Publishing, Limited.</div>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../index.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../contents/2/intro.html" class="pagination-link" aria-label="k-Nearest Neighbors algorithm (k-NN)">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">k-Nearest Neighbors algorithm (k-NN)</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>